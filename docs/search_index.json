[
["comparision-of-lofreq-and-varscan.html", "Section 7 Comparision of lofreq and varscan 7.1 major allele frequency", " Section 7 Comparision of lofreq and varscan without E. Coli dat.lo &lt;- readRDS(&quot;data/rds/variants_lofreq.rds&quot;) dat.lo &lt;- dat.lo[which(dat.lo$ecoli== FALSE),] dat.va &lt;- readRDS(&quot;data/rds/variants_varscan.rds&quot;) dat.va &lt;- dat.va[which(dat.va$ecoli== FALSE),] dat.va$dummy &lt;- 1 dat.lo$dummy &lt;- 1 dat.va.by.sample.genome &lt;- aggregate(dummy ~ mouse.id + genome, dat.va, sum) dat.va.by.sample.genome$type &lt;- &quot;varscan&quot; dat.lo.by.sample.genome &lt;- aggregate(dummy ~ mouse.id + genome, dat.lo, sum) dat.lo.by.sample.genome$type &lt;- &quot;lofreq&quot; joined.df &lt;- rbind(dat.lo.by.sample.genome, dat.va.by.sample.genome) p &lt;- ggplot(joined.df, aes(x = mouse.id, y=dummy, fill = type)) p &lt;- p + scale_y_log10() + xlab(&quot;Mouse ID&quot;) + ylab(&quot;number of variants&quot;) + theme_classic() p &lt;- p + geom_bar(stat = &quot;identity&quot;, position = position_dodge2(preserve = &quot;single&quot;)) + facet_wrap(~ genome) p 7.1 major allele frequency 7.1.1 all samples and all genomes 7.1.1.1 lofreq without E. Coli p &lt;- ggplot(dat.lo, aes(x = majorAF, y = mouse.id)) p &lt;- p + ggridges::geom_density_ridges(jittered_points = TRUE, position = ggridges::position_points_jitter(width = 0.01, height = 0), point_shape = &#39;|&#39;, point_size = 1, point_alpha = 0.5, alpha = 0.1) p &lt;- p + theme_classic() p &lt;- p + theme(strip.background = element_blank()) p &lt;- p + xlab(&quot;Major allele frequency&quot;) + ylab(&quot;Count&quot;) p ## Picking joint bandwidth of 0.0632 7.1.1.2 varscan p &lt;- ggplot(dat.va, aes(x = majorAF, y = mouse.id)) p &lt;- p + ggridges::geom_density_ridges(jittered_points = TRUE, position = ggridges::position_points_jitter(width = 0.01, height = 0), point_shape = &#39;|&#39;, point_size = 1, point_alpha = 0.5, alpha = 0.1) p &lt;- p + theme_classic() p &lt;- p + theme(strip.background = element_blank()) p &lt;- p + xlab(&quot;Major allele frequency&quot;) + ylab(&quot;Count&quot;) p ## Picking joint bandwidth of 0.0263 7.1.2 by sample and genome 7.1.2.1 lofreq plotAFofSample &lt;- function(dat = dat.lo) { p &lt;- ggplot(dat, aes(x = majorAF, y = genome, color = genome)) p &lt;- p + ggridges::geom_density_ridges(jittered_points = TRUE, position = ggridges::position_points_jitter(width = 0.01, height = 0), point_shape = &#39;|&#39;, point_size = 2, point_alpha = 1, alpha = 0.1) p &lt;- p + facet_wrap(~desc) p &lt;- p + theme_classic() + scale_color_manual(values = omm_colors) #p &lt;- p + facet_grid(phase ~., space = &quot;free&quot;, scales= &quot;free&quot;) p &lt;- p + theme(strip.background = element_blank()) p &lt;- p + xlab(&quot;Major allele frequency&quot;) + ylab(&quot;Genome&quot;) return(p) } suppressWarnings(plotAFofSample(dat.lo)) ## Picking joint bandwidth of 0.0565 ## Picking joint bandwidth of 0.0601 ## Picking joint bandwidth of 0.0492 ## Picking joint bandwidth of 0.0549 ## Picking joint bandwidth of 0.0513 ## Picking joint bandwidth of 0.0366 ## Picking joint bandwidth of 0.0626 ## Picking joint bandwidth of 0.0767 ## Picking joint bandwidth of 0.0482 7.1.2.2 varscan plotAFofSample &lt;- function(dat = dat) { p &lt;- ggplot(dat, aes(x = majorAF, y = genome, color = genome)) p &lt;- p + ggridges::geom_density_ridges(jittered_points = TRUE, position = ggridges::position_points_jitter(width = 0.01, height = 0), point_shape = &#39;|&#39;, point_size = 2, point_alpha = 1, alpha = 0.1) p &lt;- p + facet_wrap(~desc) p &lt;- p + theme_classic() + scale_color_manual(values = omm_colors) #p &lt;- p + facet_grid(phase ~., space = &quot;free&quot;, scales= &quot;free&quot;) p &lt;- p + theme(strip.background = element_blank()) p &lt;- p + xlab(&quot;Major allele frequency&quot;) + ylab(&quot;Genome&quot;) return(p) } suppressWarnings(plotAFofSample(dat.va)) ## Picking joint bandwidth of 0.028 ## Picking joint bandwidth of 0.0449 ## Picking joint bandwidth of 0.0393 ## Picking joint bandwidth of 0.0418 ## Picking joint bandwidth of 0.0378 ## Picking joint bandwidth of 0.0364 ## Picking joint bandwidth of 0.0488 ## Picking joint bandwidth of 0.0475 ## Picking joint bandwidth of 0.0356 "]
]
