[
["Allele-frequency.html", "Section 4 Allele frequency 4.1 major allele frequency", " Section 4 Allele frequency 4.1 major allele frequency 4.1.1 all samples and all genomes without E. Coli dat &lt;- readRDS(&quot;data/rds/variants.rds&quot;) dat &lt;- dat[which(dat$ecoli== FALSE),] p &lt;- ggplot(dat, aes(x = majorAF, y = mouse.id)) p &lt;- p + ggridges::geom_density_ridges(jittered_points = TRUE, position = ggridges::position_points_jitter(width = 0.01, height = 0), point_shape = &#39;|&#39;, point_size = 1, point_alpha = 0.5, alpha = 0.1) p &lt;- p + theme_classic() p &lt;- p + theme(strip.background = element_blank()) p &lt;- p + xlab(&quot;Major allele frequency&quot;) + ylab(&quot;Count&quot;) p ## Picking joint bandwidth of 0.0632 4.1.2 by sample and genome plotAFofSample &lt;- function(dat = dat) { p &lt;- ggplot(dat, aes(x = majorAF, y = genome, color = genome)) p &lt;- p + ggridges::geom_density_ridges(jittered_points = TRUE, position = ggridges::position_points_jitter(width = 0.01, height = 0), point_shape = &#39;|&#39;, point_size = 2, point_alpha = 1, alpha = 0.1) p &lt;- p + facet_wrap(~desc) p &lt;- p + theme_classic() + scale_color_manual(values = omm_colors) #p &lt;- p + facet_grid(phase ~., space = &quot;free&quot;, scales= &quot;free&quot;) p &lt;- p + theme(strip.background = element_blank()) p &lt;- p + xlab(&quot;Major allele frequency&quot;) + ylab(&quot;Genome&quot;) return(p) } suppressWarnings(plotAFofSample(dat)) ## Picking joint bandwidth of 0.0565 ## Picking joint bandwidth of 0.0601 ## Picking joint bandwidth of 0.0492 ## Picking joint bandwidth of 0.0549 ## Picking joint bandwidth of 0.0513 ## Picking joint bandwidth of 0.0366 ## Picking joint bandwidth of 0.0626 ## Picking joint bandwidth of 0.0767 ## Picking joint bandwidth of 0.0482 "]
]
