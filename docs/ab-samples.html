<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 4 AB Samples | OMM report</title>
  <meta name="description" content="Section 4 AB Samples | OMM report" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 4 AB Samples | OMM report" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 4 AB Samples | OMM report" />
  
  
  

<meta name="author" content="Philipp C. Muench" />


<meta name="date" content="2020-06-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="resequencing-samples.html"/>
<link rel="next" href="limit-to-variants-that-have-a-high-variance.html"/>
<script src="libs/header-attrs-2.1/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.10/datatables.js"></script>
<link href="libs/dt-core-1.10.19/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.19/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.19/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<script src="libs/plotly-binding-4.9.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.49.4/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.49.4/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Setup</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i><b>1.1</b> Installation</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#generate-report"><i class="fa fa-check"></i><b>1.2</b> Generate report</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="claudia-samples.html"><a href="claudia-samples.html"><i class="fa fa-check"></i><b>2</b> Claudia Samples</a>
<ul>
<li class="chapter" data-level="2.1" data-path="claudia-samples.html"><a href="claudia-samples.html#experiment"><i class="fa fa-check"></i><b>2.1</b> Experiment</a></li>
<li class="chapter" data-level="2.2" data-path="claudia-samples.html"><a href="claudia-samples.html#metadata"><i class="fa fa-check"></i><b>2.2</b> Metadata</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="claudia-samples.html"><a href="claudia-samples.html#crispr"><i class="fa fa-check"></i><b>2.2.1</b> CRISPR</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="resequencing-samples.html"><a href="resequencing-samples.html"><i class="fa fa-check"></i><b>3</b> Resequencing Samples</a>
<ul>
<li class="chapter" data-level="3.1" data-path="resequencing-samples.html"><a href="resequencing-samples.html#metadata-1"><i class="fa fa-check"></i><b>3.1</b> Metadata</a></li>
<li class="chapter" data-level="3.2" data-path="resequencing-samples.html"><a href="resequencing-samples.html#load-in-variants"><i class="fa fa-check"></i><b>3.2</b> Load in variants</a></li>
<li class="chapter" data-level="3.3" data-path="resequencing-samples.html"><a href="resequencing-samples.html#kb1"><i class="fa fa-check"></i><b>3.3</b> KB1</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="resequencing-samples.html"><a href="resequencing-samples.html#snp"><i class="fa fa-check"></i><b>3.3.1</b> SNP</a></li>
<li class="chapter" data-level="3.3.2" data-path="resequencing-samples.html"><a href="resequencing-samples.html#insertion"><i class="fa fa-check"></i><b>3.3.2</b> insertion</a></li>
<li class="chapter" data-level="3.3.3" data-path="resequencing-samples.html"><a href="resequencing-samples.html#deletion"><i class="fa fa-check"></i><b>3.3.3</b> deletion</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="resequencing-samples.html"><a href="resequencing-samples.html#i46"><i class="fa fa-check"></i><b>3.4</b> I46</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="resequencing-samples.html"><a href="resequencing-samples.html#snp-1"><i class="fa fa-check"></i><b>3.4.1</b> SNP</a></li>
<li class="chapter" data-level="3.4.2" data-path="resequencing-samples.html"><a href="resequencing-samples.html#insertion-1"><i class="fa fa-check"></i><b>3.4.2</b> insertion</a></li>
<li class="chapter" data-level="3.4.3" data-path="resequencing-samples.html"><a href="resequencing-samples.html#deletion-1"><i class="fa fa-check"></i><b>3.4.3</b> deletion</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="resequencing-samples.html"><a href="resequencing-samples.html#yl58"><i class="fa fa-check"></i><b>3.5</b> YL58</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="resequencing-samples.html"><a href="resequencing-samples.html#snp-2"><i class="fa fa-check"></i><b>3.5.1</b> SNP</a></li>
<li class="chapter" data-level="3.5.2" data-path="resequencing-samples.html"><a href="resequencing-samples.html#insertion-2"><i class="fa fa-check"></i><b>3.5.2</b> insertion</a></li>
<li class="chapter" data-level="3.5.3" data-path="resequencing-samples.html"><a href="resequencing-samples.html#deletion-2"><i class="fa fa-check"></i><b>3.5.3</b> deletion</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="resequencing-samples.html"><a href="resequencing-samples.html#mutation-bias"><i class="fa fa-check"></i><b>3.6</b> mutation bias?</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="resequencing-samples.html"><a href="resequencing-samples.html#snp-3"><i class="fa fa-check"></i><b>3.6.1</b> SNP</a></li>
<li class="chapter" data-level="3.6.2" data-path="resequencing-samples.html"><a href="resequencing-samples.html#insertions"><i class="fa fa-check"></i><b>3.6.2</b> insertions</a></li>
<li class="chapter" data-level="3.6.3" data-path="resequencing-samples.html"><a href="resequencing-samples.html#deletions"><i class="fa fa-check"></i><b>3.6.3</b> deletions</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="resequencing-samples.html"><a href="resequencing-samples.html#heatmap"><i class="fa fa-check"></i><b>3.7</b> heatmap</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="resequencing-samples.html"><a href="resequencing-samples.html#kb1-1"><i class="fa fa-check"></i><b>3.7.1</b> KB1</a></li>
<li class="chapter" data-level="3.7.2" data-path="resequencing-samples.html"><a href="resequencing-samples.html#i46-1"><i class="fa fa-check"></i><b>3.7.2</b> I46</a></li>
<li class="chapter" data-level="3.7.3" data-path="resequencing-samples.html"><a href="resequencing-samples.html#yl58-1"><i class="fa fa-check"></i><b>3.7.3</b> YL58</a></li>
<li class="chapter" data-level="3.7.4" data-path="resequencing-samples.html"><a href="resequencing-samples.html#filter-present-in-all"><i class="fa fa-check"></i><b>3.7.4</b> Filter: present in all</a></li>
<li class="chapter" data-level="3.7.5" data-path="resequencing-samples.html"><a href="resequencing-samples.html#kb1-2"><i class="fa fa-check"></i><b>3.7.5</b> KB1</a></li>
<li class="chapter" data-level="3.7.6" data-path="resequencing-samples.html"><a href="resequencing-samples.html#yl58-2"><i class="fa fa-check"></i><b>3.7.6</b> YL58</a></li>
<li class="chapter" data-level="3.7.7" data-path="resequencing-samples.html"><a href="resequencing-samples.html#i46-2"><i class="fa fa-check"></i><b>3.7.7</b> I46</a></li>
<li class="chapter" data-level="3.7.8" data-path="resequencing-samples.html"><a href="resequencing-samples.html#filter-not-in-water-but-in-ab"><i class="fa fa-check"></i><b>3.7.8</b> Filter: not in water but in AB</a></li>
<li class="chapter" data-level="3.7.9" data-path="resequencing-samples.html"><a href="resequencing-samples.html#kb1-3"><i class="fa fa-check"></i><b>3.7.9</b> KB1</a></li>
<li class="chapter" data-level="3.7.10" data-path="resequencing-samples.html"><a href="resequencing-samples.html#yl58-3"><i class="fa fa-check"></i><b>3.7.10</b> YL58</a></li>
<li class="chapter" data-level="3.7.11" data-path="resequencing-samples.html"><a href="resequencing-samples.html#i46-3"><i class="fa fa-check"></i><b>3.7.11</b> I46</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="resequencing-samples.html"><a href="resequencing-samples.html#visualize-coverage"><i class="fa fa-check"></i><b>3.8</b> visualize coverage</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ab-samples.html"><a href="ab-samples.html"><i class="fa fa-check"></i><b>4</b> AB Samples</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ab-samples.html"><a href="ab-samples.html#load-in-variants-1"><i class="fa fa-check"></i><b>4.1</b> Load in variants</a></li>
<li class="chapter" data-level="4.2" data-path="ab-samples.html"><a href="ab-samples.html#af-frequency"><i class="fa fa-check"></i><b>4.2</b> AF frequency</a></li>
<li class="chapter" data-level="4.3" data-path="ab-samples.html"><a href="ab-samples.html#number-of-variants-per-samples"><i class="fa fa-check"></i><b>4.3</b> number of variants per samples</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="ab-samples.html"><a href="ab-samples.html#number-of-variants-per-treatment-group"><i class="fa fa-check"></i><b>4.3.1</b> number of variants per treatment group</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="ab-samples.html"><a href="ab-samples.html#heatmap-1"><i class="fa fa-check"></i><b>4.4</b> Heatmap</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="limit-to-variants-that-have-a-high-variance.html"><a href="limit-to-variants-that-have-a-high-variance.html"><i class="fa fa-check"></i><b>5</b> limit to variants that have a high variance</a></li>
<li class="chapter" data-level="6" data-path="order-the-heatmap-by-treatment-group.html"><a href="order-the-heatmap-by-treatment-group.html"><i class="fa fa-check"></i><b>6</b> order the heatmap by treatment group</a>
<ul>
<li class="chapter" data-level="6.1" data-path="order-the-heatmap-by-treatment-group.html"><a href="order-the-heatmap-by-treatment-group.html#akkermansia-muciniphila"><i class="fa fa-check"></i><b>6.1</b> Akkermansia Muciniphila</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="order-the-heatmap-by-treatment-group.html"><a href="order-the-heatmap-by-treatment-group.html#area-plot-1"><i class="fa fa-check"></i><b>6.1.1</b> area plot 1</a></li>
<li class="chapter" data-level="6.1.2" data-path="order-the-heatmap-by-treatment-group.html"><a href="order-the-heatmap-by-treatment-group.html#line-plot"><i class="fa fa-check"></i><b>6.1.2</b> line plot</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">OMM report</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ab-samples" class="section level1" number="4">
<h1><span class="header-section-number">Section 4</span> AB Samples</h1>
<div id="load-in-variants-1" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Load in variants</h2>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="ab-samples.html#cb84-1"></a>vcfToDataframe &lt;-<span class="st"> </span><span class="cf">function</span>(vcf.files, <span class="dt">contig_mapping =</span> contig_mapping, <span class="dt">gff.df =</span> gff.df) {</span>
<span id="cb84-2"><a href="ab-samples.html#cb84-2"></a>    <span class="kw">require</span>(vcfR)</span>
<span id="cb84-3"><a href="ab-samples.html#cb84-3"></a>    res &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb84-4"><a href="ab-samples.html#cb84-4"></a>    <span class="cf">for</span> (file <span class="cf">in</span> vcf.files) {</span>
<span id="cb84-5"><a href="ab-samples.html#cb84-5"></a>        <span class="kw">library</span>(data.table)</span>
<span id="cb84-6"><a href="ab-samples.html#cb84-6"></a>        vcf.content &lt;-<span class="st"> </span>vcfR<span class="op">::</span><span class="kw">read.vcfR</span>(file, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span>
<span id="cb84-7"><a href="ab-samples.html#cb84-7"></a>        vcf.fix &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(vcf.content<span class="op">@</span>fix)  <span class="co"># contains chr, position and substitution informations</span></span>
<span id="cb84-8"><a href="ab-samples.html#cb84-8"></a>        vcf.info &lt;-<span class="st"> </span>vcfR<span class="op">::</span><span class="kw">INFO2df</span>(vcf.content)  <span class="co"># get INFO field, contains DP, AF informations</span></span>
<span id="cb84-9"><a href="ab-samples.html#cb84-9"></a>        <span class="cf">if</span> (<span class="kw">nrow</span>(vcf.fix) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) {</span>
<span id="cb84-10"><a href="ab-samples.html#cb84-10"></a>            <span class="co"># there are variants</span></span>
<span id="cb84-11"><a href="ab-samples.html#cb84-11"></a>            dat &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">cbind</span>(vcf.fix[, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)], vcf.info[, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)]))</span>
<span id="cb84-12"><a href="ab-samples.html#cb84-12"></a>            dat<span class="op">$</span>majorAF &lt;-<span class="st"> </span><span class="kw">sapply</span>(dat<span class="op">$</span>AF, minorAfToMajorAf)  <span class="co"># transforms e.g. AF of 0.1 to 0.9, 0.9 stays 0.9 and 0.5 stays 0.5</span></span>
<span id="cb84-13"><a href="ab-samples.html#cb84-13"></a>            dat<span class="op">$</span>genome &lt;-<span class="st"> </span>contig_mapping[<span class="kw">match</span>(dat<span class="op">$</span>CHROM, contig_mapping<span class="op">$</span>contig), ]<span class="op">$</span>genome  <span class="co"># map chr information to genome name e.g. NHMU01000001.1 -&gt; i48</span></span>
<span id="cb84-14"><a href="ab-samples.html#cb84-14"></a>            dat<span class="op">$</span>genome_hr &lt;-<span class="st"> </span><span class="kw">translateGenomeIdToFullName</span>(<span class="kw">tolower</span>(dat<span class="op">$</span>genome))</span>
<span id="cb84-15"><a href="ab-samples.html#cb84-15"></a>            dat<span class="op">$</span>mouse.id &lt;-<span class="st"> </span><span class="kw">substr</span>(tools<span class="op">::</span><span class="kw">file_path_sans_ext</span>(<span class="kw">basename</span>(file)), <span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb84-16"><a href="ab-samples.html#cb84-16"></a>            dat<span class="op">$</span>mouse.group &lt;-<span class="st"> </span><span class="kw">translateMouseIdToTreatmentGroup</span>(dat<span class="op">$</span>mouse.id)</span>
<span id="cb84-17"><a href="ab-samples.html#cb84-17"></a>            dat<span class="op">$</span>day &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">substr</span>(<span class="kw">basename</span>(file), <span class="dv">6</span>, <span class="dv">7</span>))</span>
<span id="cb84-18"><a href="ab-samples.html#cb84-18"></a>            dat<span class="op">$</span>phase &lt;-<span class="st"> </span><span class="kw">binDaysByPhase</span>(<span class="kw">as.numeric</span>(<span class="kw">as.matrix</span>(dat<span class="op">$</span>day)))</span>
<span id="cb84-19"><a href="ab-samples.html#cb84-19"></a>            dat<span class="op">$</span>phase_num &lt;-<span class="st"> </span><span class="kw">binDaysByPhaseGroup</span>(dat<span class="op">$</span>day)</span>
<span id="cb84-20"><a href="ab-samples.html#cb84-20"></a>            dat<span class="op">$</span>dp &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">as.matrix</span>(vcf.info<span class="op">$</span>DP))</span>
<span id="cb84-21"><a href="ab-samples.html#cb84-21"></a>            <span class="co"># annotate overlay of gene</span></span>
<span id="cb84-22"><a href="ab-samples.html#cb84-22"></a>            dt.gff &lt;-<span class="st"> </span><span class="kw">data.table</span>(<span class="dt">start =</span> gff.df<span class="op">$</span>start, <span class="dt">end =</span> gff.df<span class="op">$</span>end, <span class="dt">chr =</span> <span class="kw">as.character</span>(<span class="kw">as.matrix</span>(gff.df<span class="op">$</span>chr)), <span class="dt">feature =</span> gff.df<span class="op">$</span>product)</span>
<span id="cb84-23"><a href="ab-samples.html#cb84-23"></a>            <span class="kw">colnames</span>(dat)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;chr&quot;</span>, <span class="st">&quot;start&quot;</span>)</span>
<span id="cb84-24"><a href="ab-samples.html#cb84-24"></a>            dat<span class="op">$</span>start &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">as.matrix</span>(dat<span class="op">$</span>start))</span>
<span id="cb84-25"><a href="ab-samples.html#cb84-25"></a>            dat<span class="op">$</span>chr &lt;-<span class="st"> </span><span class="kw">as.character</span>(<span class="kw">as.matrix</span>(dat<span class="op">$</span>chr))</span>
<span id="cb84-26"><a href="ab-samples.html#cb84-26"></a>            dat<span class="op">$</span>end &lt;-<span class="st"> </span>dat<span class="op">$</span>start</span>
<span id="cb84-27"><a href="ab-samples.html#cb84-27"></a>            dat2 &lt;-<span class="st"> </span><span class="kw">as.data.table</span>(dat)</span>
<span id="cb84-28"><a href="ab-samples.html#cb84-28"></a>            <span class="kw">setkey</span>(dt.gff, chr, start, end)</span>
<span id="cb84-29"><a href="ab-samples.html#cb84-29"></a>            annotated &lt;-<span class="st"> </span><span class="kw">foverlaps</span>(dat2, dt.gff, <span class="dt">type =</span> <span class="st">&quot;within&quot;</span>, <span class="dt">mult =</span> <span class="st">&quot;first&quot;</span>)</span>
<span id="cb84-30"><a href="ab-samples.html#cb84-30"></a>            res[[tools<span class="op">::</span><span class="kw">file_path_sans_ext</span>(<span class="kw">basename</span>(file))]] &lt;-<span class="st"> </span>annotated  <span class="co"># add vcf df to list</span></span>
<span id="cb84-31"><a href="ab-samples.html#cb84-31"></a>        } <span class="cf">else</span> {</span>
<span id="cb84-32"><a href="ab-samples.html#cb84-32"></a>            <span class="kw">message</span>(<span class="st">&quot;Skipping&quot;</span>)</span>
<span id="cb84-33"><a href="ab-samples.html#cb84-33"></a>        }</span>
<span id="cb84-34"><a href="ab-samples.html#cb84-34"></a>    }</span>
<span id="cb84-35"><a href="ab-samples.html#cb84-35"></a>    df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">do.call</span>(rbind, res))  <span class="co"># merge list to df</span></span>
<span id="cb84-36"><a href="ab-samples.html#cb84-36"></a>    <span class="kw">return</span>(df)</span>
<span id="cb84-37"><a href="ab-samples.html#cb84-37"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="ab-samples.html#cb85-1"></a><span class="co"># load in reference information</span></span>
<span id="cb85-2"><a href="ab-samples.html#cb85-2"></a>gff.files &lt;-<span class="st"> </span><span class="kw">Sys.glob</span>(<span class="st">&quot;data/references/joined_reference_curated_ecoli/*.gff&quot;</span>)</span>
<span id="cb85-3"><a href="ab-samples.html#cb85-3"></a>gff.df &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb85-4"><a href="ab-samples.html#cb85-4"></a><span class="cf">for</span> (gff.file <span class="cf">in</span> gff.files) {</span>
<span id="cb85-5"><a href="ab-samples.html#cb85-5"></a>    <span class="kw">message</span>(gff.file)</span>
<span id="cb85-6"><a href="ab-samples.html#cb85-6"></a>    gff &lt;-<span class="st"> </span>rtracklayer<span class="op">::</span><span class="kw">readGFF</span>(gff.file)</span>
<span id="cb85-7"><a href="ab-samples.html#cb85-7"></a>    <span class="co"># subset since different columns are present on gff files</span></span>
<span id="cb85-8"><a href="ab-samples.html#cb85-8"></a>    relevant &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">start =</span> gff<span class="op">$</span>start, <span class="dt">end =</span> gff<span class="op">$</span>end, <span class="dt">type =</span> <span class="kw">as.character</span>(<span class="kw">as.matrix</span>(gff<span class="op">$</span>type)), <span class="dt">gene =</span> <span class="kw">as.character</span>(<span class="kw">as.matrix</span>(gff<span class="op">$</span>gene)), <span class="dt">product =</span> <span class="kw">as.character</span>(<span class="kw">as.matrix</span>(gff<span class="op">$</span>product)), </span>
<span id="cb85-9"><a href="ab-samples.html#cb85-9"></a>        <span class="dt">chr =</span> <span class="kw">as.character</span>(<span class="kw">as.matrix</span>(gff<span class="op">$</span>seqid)))</span>
<span id="cb85-10"><a href="ab-samples.html#cb85-10"></a>    relevant<span class="op">$</span>genome &lt;-<span class="st"> </span><span class="kw">substr</span>(<span class="kw">basename</span>(gff.file), <span class="dv">1</span>, <span class="kw">nchar</span>(<span class="kw">basename</span>(gff.file)) <span class="op">-</span><span class="st"> </span><span class="dv">4</span>)</span>
<span id="cb85-11"><a href="ab-samples.html#cb85-11"></a>    gff.df &lt;-<span class="st"> </span><span class="kw">rbind</span>(gff.df, relevant)</span>
<span id="cb85-12"><a href="ab-samples.html#cb85-12"></a>}</span></code></pre></div>
<pre><code>## data/references/joined_reference_curated_ecoli/joined_reference_curated_ecoli.gff</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="ab-samples.html#cb87-1"></a><span class="co"># load in contig information</span></span>
<span id="cb87-2"><a href="ab-samples.html#cb87-2"></a>contig_mapping &lt;-<span class="st"> </span><span class="kw">read.csv2</span>(<span class="st">&quot;data/contig_mapping_new_ref.csv&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;;&quot;</span>, <span class="dt">header =</span> T, <span class="dt">stringsAsFactors =</span> F)  <span class="co"># this file contains contig names of the 12 OligoMM genomes</span></span>
<span id="cb87-3"><a href="ab-samples.html#cb87-3"></a></span>
<span id="cb87-4"><a href="ab-samples.html#cb87-4"></a><span class="co"># load in vcf files</span></span>
<span id="cb87-5"><a href="ab-samples.html#cb87-5"></a>vcf.files &lt;-<span class="st"> </span><span class="kw">Sys.glob</span>(<span class="st">&quot;out_philipp/all_vcf/*.vcf&quot;</span>)</span>
<span id="cb87-6"><a href="ab-samples.html#cb87-6"></a>vcf.samples &lt;-<span class="st"> </span><span class="kw">suppressWarnings</span>(<span class="kw">vcfToDataframe</span>(vcf.files, contig_mapping, <span class="dt">gff.df =</span> gff.df))</span></code></pre></div>
<pre><code>## Skipping</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="ab-samples.html#cb89-1"></a>vcf.samples<span class="op">$</span>feature &lt;-<span class="st"> </span><span class="kw">as.character</span>(<span class="kw">as.matrix</span>(vcf.samples<span class="op">$</span>feature))</span>
<span id="cb89-2"><a href="ab-samples.html#cb89-2"></a></span>
<span id="cb89-3"><a href="ab-samples.html#cb89-3"></a>vcf.samples[<span class="kw">which</span>(<span class="kw">is.na</span>(vcf.samples<span class="op">$</span>feature)), ]<span class="op">$</span>feature &lt;-<span class="st"> &quot;outside ORFs&quot;</span></span>
<span id="cb89-4"><a href="ab-samples.html#cb89-4"></a></span>
<span id="cb89-5"><a href="ab-samples.html#cb89-5"></a>vcf.samples<span class="op">$</span>start &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb89-6"><a href="ab-samples.html#cb89-6"></a>vcf.samples<span class="op">$</span>end &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb89-7"><a href="ab-samples.html#cb89-7"></a>vcf.samples<span class="op">$</span>i.end &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb89-8"><a href="ab-samples.html#cb89-8"></a><span class="kw">colnames</span>(vcf.samples)[<span class="dv">3</span>] &lt;-<span class="st"> &quot;POS&quot;</span></span>
<span id="cb89-9"><a href="ab-samples.html#cb89-9"></a></span>
<span id="cb89-10"><a href="ab-samples.html#cb89-10"></a><span class="kw">saveRDS</span>(vcf.samples, <span class="dt">file =</span> <span class="st">&quot;data/rds/omm_ab.rds&quot;</span>)</span></code></pre></div>
</div>
<div id="af-frequency" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> AF frequency</h2>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="ab-samples.html#cb90-1"></a>p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(vcf.samples, <span class="kw">aes</span>(AF, <span class="dt">fill =</span> genome)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>()</span>
<span id="cb90-2"><a href="ab-samples.html#cb90-2"></a>p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(mouse.id <span class="op">+</span><span class="st"> </span>mouse.group <span class="op">~</span><span class="st"> </span>genome <span class="op">+</span><span class="st"> </span>genome_hr)</span>
<span id="cb90-3"><a href="ab-samples.html#cb90-3"></a>p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;AF&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;occurence&quot;</span>)</span>
<span id="cb90-4"><a href="ab-samples.html#cb90-4"></a><span class="kw">print</span>(p)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-30"></span>
<img src="oligomm-claudia_files/figure-html/unnamed-chunk-30-1.png" alt="AF of resequenced strains" width="1440" />
<p class="caption">
Figure 4.1: AF of resequenced strains
</p>
</div>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="ab-samples.html#cb92-1"></a>p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(vcf.samples, <span class="kw">aes</span>(majorAF, <span class="dt">fill =</span> genome)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>()</span>
<span id="cb92-2"><a href="ab-samples.html#cb92-2"></a>p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(mouse.id <span class="op">+</span><span class="st"> </span>mouse.group <span class="op">~</span><span class="st"> </span>genome <span class="op">+</span><span class="st"> </span>genome_hr)</span>
<span id="cb92-3"><a href="ab-samples.html#cb92-3"></a>p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;AF&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;occurence&quot;</span>)</span>
<span id="cb92-4"><a href="ab-samples.html#cb92-4"></a><span class="kw">print</span>(p)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-31"></span>
<img src="oligomm-claudia_files/figure-html/unnamed-chunk-31-1.png" alt="major AF of resequenced strains" width="1440" />
<p class="caption">
Figure 4.2: major AF of resequenced strains
</p>
</div>
</div>
<div id="number-of-variants-per-samples" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> number of variants per samples</h2>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="ab-samples.html#cb94-1"></a>dat &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;data/rds/omm_ab.rds&quot;</span>)</span>
<span id="cb94-2"><a href="ab-samples.html#cb94-2"></a>dat<span class="op">$</span>dummy &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb94-3"><a href="ab-samples.html#cb94-3"></a>dat.agg &lt;-<span class="st"> </span><span class="kw">aggregate</span>(dummy <span class="op">~</span><span class="st"> </span>mouse.id <span class="op">+</span><span class="st"> </span>mouse.group <span class="op">+</span><span class="st"> </span>day <span class="op">+</span><span class="st"> </span>phase, dat, sum)</span>
<span id="cb94-4"><a href="ab-samples.html#cb94-4"></a>DT<span class="op">::</span><span class="kw">datatable</span>(dat.agg)</span></code></pre></div>
<div id="htmlwidget-ed2e2857e78b9b42f68e" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-ed2e2857e78b9b42f68e">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110"],["1688","1692","1699","1688","1692","1699","1683","1686","1688","1690","1692","1693","1694","1697","1698","1699","1681","1683","1684","1688","1692","1699","1683","1688","1692","1699","1683","1688","1692","1699","1683","1688","1692","1699","1683","1686","1688","1690","1692","1693","1694","1697","1698","1699","1681","1683","1684","1688","1692","1699","1686","1688","1690","1692","1693","1694","1697","1698","1699","1681","1683","1684","1688","1692","1699","1683","1686","1688","1690","1692","1693","1694","1697","1698","1699","1681","1683","1684","1688","1692","1699","1683","1686","1688","1690","1692","1693","1694","1697","1698","1699","1681","1683","1684","1688","1692","1699","1683","1686","1688","1690","1692","1693","1694","1697","1698","1699","1681","1683","1684"],["Ciprofloxacin","Tetracyclin","Vancomycin","Ciprofloxacin","Tetracyclin","Vancomycin","Water","Ciprofloxacin","Ciprofloxacin","Ciprofloxacin","Tetracyclin","Tetracyclin","Tetracyclin","Vancomycin","Vancomycin","Vancomycin","Water","Water","Water","Ciprofloxacin","Tetracyclin","Vancomycin","Water","Ciprofloxacin","Tetracyclin","Vancomycin","Water","Ciprofloxacin","Tetracyclin","Vancomycin","Water","Ciprofloxacin","Tetracyclin","Vancomycin","Water","Ciprofloxacin","Ciprofloxacin","Ciprofloxacin","Tetracyclin","Tetracyclin","Tetracyclin","Vancomycin","Vancomycin","Vancomycin","Water","Water","Water","Ciprofloxacin","Tetracyclin","Vancomycin","Ciprofloxacin","Ciprofloxacin","Ciprofloxacin","Tetracyclin","Tetracyclin","Tetracyclin","Vancomycin","Vancomycin","Vancomycin","Water","Water","Water","Ciprofloxacin","Tetracyclin","Vancomycin","Water","Ciprofloxacin","Ciprofloxacin","Ciprofloxacin","Tetracyclin","Tetracyclin","Tetracyclin","Vancomycin","Vancomycin","Vancomycin","Water","Water","Water","Ciprofloxacin","Tetracyclin","Vancomycin","Water","Ciprofloxacin","Ciprofloxacin","Ciprofloxacin","Tetracyclin","Tetracyclin","Tetracyclin","Vancomycin","Vancomycin","Vancomycin","Water","Water","Water","Ciprofloxacin","Tetracyclin","Vancomycin","Water","Ciprofloxacin","Ciprofloxacin","Ciprofloxacin","Tetracyclin","Tetracyclin","Tetracyclin","Vancomycin","Vancomycin","Vancomycin","Water","Water","Water"],[37,37,37,44,44,44,44,49,49,49,49,49,49,49,49,49,49,49,49,4,4,4,4,18,18,18,18,53,53,53,53,67,67,67,67,0,0,0,0,0,0,0,0,0,0,0,0,9,9,9,14,14,14,14,14,14,14,14,14,14,14,14,23,23,23,23,30,30,30,30,30,30,30,30,30,30,30,30,58,58,58,58,63,63,63,63,63,63,63,63,63,63,63,63,72,72,72,72,79,79,79,79,79,79,79,79,79,79,79,79],["long-recovery","long-recovery","long-recovery","long-recovery","long-recovery","long-recovery","long-recovery","long-recovery","long-recovery","long-recovery","long-recovery","long-recovery","long-recovery","long-recovery","long-recovery","long-recovery","long-recovery","long-recovery","long-recovery","post-treatment","post-treatment","post-treatment","post-treatment","post-treatment","post-treatment","post-treatment","post-treatment","post-treatment","post-treatment","post-treatment","post-treatment","post-treatment","post-treatment","post-treatment","post-treatment","pre-treatment","pre-treatment","pre-treatment","pre-treatment","pre-treatment","pre-treatment","pre-treatment","pre-treatment","pre-treatment","pre-treatment","pre-treatment","pre-treatment","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery","short-recovery"],[1331,1448,1314,1683,1405,1154,1612,1740,1480,1547,1438,1648,1667,1313,1051,1104,1412,1584,1345,1499,661,999,1448,1313,1562,851,1471,1525,1288,880,1664,1637,1021,808,1555,1576,1292,1512,1548,1561,1236,1245,1560,1690,1179,1669,1061,1449,1339,1345,1747,1323,1851,1698,1767,1502,1248,1016,1239,1245,1423,1081,1497,1652,1212,1424,1775,1369,1664,1457,1656,1808,1191,1168,1410,1396,1549,1255,1674,1542,1182,1500,1544,1579,1648,1556,1659,1598,1157,1302,1342,1204,1624,1286,1475,2410,1349,1577,1425,1382,1557,1584,1840,1300,1026,1384,1292,1113,1504,1051]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>mouse.id<\/th>\n      <th>mouse.group<\/th>\n      <th>day<\/th>\n      <th>phase<\/th>\n      <th>dummy<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div id="number-of-variants-per-treatment-group" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> number of variants per treatment group</h3>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="ab-samples.html#cb95-1"></a>p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(dat.agg, <span class="kw">aes</span>(<span class="dt">x =</span> mouse.id, <span class="dt">y =</span> dummy, <span class="dt">color =</span> day))</span>
<span id="cb95-2"><a href="ab-samples.html#cb95-2"></a>p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_jitter</span>(<span class="dt">shape =</span> <span class="dv">4</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>mouse.group, <span class="dt">scales =</span> <span class="st">&quot;free_x&quot;</span>)</span>
<span id="cb95-3"><a href="ab-samples.html#cb95-3"></a>p &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Mouse ID&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;number of variants&quot;</span>)</span>
<span id="cb95-4"><a href="ab-samples.html#cb95-4"></a>plotly<span class="op">::</span><span class="kw">ggplotly</span>(p)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-33"></span>
<div id="htmlwidget-5fa98c30312bead23abe" style="width:960px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-5fa98c30312bead23abe">{"x":{"data":[{"x":[1.8831132363528,1.6491756837815,0.826944872364402,1.74692991841584,2.61225699167699,1.79681757483631,2.27528458219022,2.11919590700418,1.6216661836952,0.883307165652514,2.01085951440036,2.88781436942518,1.83903268799186,1.05319851506501,1.92010613437742,3.02967430967838,1.9352543707937,0.724724769406021,2.36283089965582,3.36723756566644,2.12136213183403,1.13261767458171,1.69474749825895,3.0114216171205,2.12491141539067,0.887393609061837,1.89621652923524,2.66918495371938],"y":[1331.08951014765,1683.02109013144,1740.08402628507,1479.63309076484,1546.86183085758,1499.26977039445,1312.86733538602,1524.95068761185,1637.20954662822,1576.04647210725,1292.28860226665,1512.33807400484,1449.19323318787,1746.696652852,1323.20056439731,1851.00362131726,1497.27359206099,1774.77473382764,1368.94944663774,1664.13821348008,1674.13275369164,1543.93048267849,1579.33620423526,1648.09444795419,1474.69940490928,1425.3137574235,1381.66679858547,1556.65582412388],"text":["mouse.id: 1688<br />dummy: 1331<br />day: 37","mouse.id: 1688<br />dummy: 1683<br />day: 44","mouse.id: 1686<br />dummy: 1740<br />day: 49","mouse.id: 1688<br />dummy: 1480<br />day: 49","mouse.id: 1690<br />dummy: 1547<br />day: 49","mouse.id: 1688<br />dummy: 1499<br />day:  4","mouse.id: 1688<br />dummy: 1313<br />day: 18","mouse.id: 1688<br />dummy: 1525<br />day: 53","mouse.id: 1688<br />dummy: 1637<br />day: 67","mouse.id: 1686<br />dummy: 1576<br />day:  0","mouse.id: 1688<br />dummy: 1292<br />day:  0","mouse.id: 1690<br />dummy: 1512<br />day:  0","mouse.id: 1688<br />dummy: 1449<br />day:  9","mouse.id: 1686<br />dummy: 1747<br />day: 14","mouse.id: 1688<br />dummy: 1323<br />day: 14","mouse.id: 1690<br />dummy: 1851<br />day: 14","mouse.id: 1688<br />dummy: 1497<br />day: 23","mouse.id: 1686<br />dummy: 1775<br />day: 30","mouse.id: 1688<br />dummy: 1369<br />day: 30","mouse.id: 1690<br />dummy: 1664<br />day: 30","mouse.id: 1688<br />dummy: 1674<br />day: 58","mouse.id: 1686<br />dummy: 1544<br />day: 63","mouse.id: 1688<br />dummy: 1579<br />day: 63","mouse.id: 1690<br />dummy: 1648<br />day: 63","mouse.id: 1688<br />dummy: 1475<br />day: 72","mouse.id: 1686<br />dummy: 1425<br />day: 79","mouse.id: 1688<br />dummy: 1382<br />day: 79","mouse.id: 1690<br />dummy: 1557<br />day: 79"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":["rgba(49,102,146,1)","rgba(55,114,162,1)","rgba(59,123,174,1)","rgba(59,123,174,1)","rgba(59,123,174,1)","rgba(22,49,75,1)","rgba(33,71,104,1)","rgba(62,130,183,1)","rgba(75,155,217,1)","rgba(19,43,67,1)","rgba(19,43,67,1)","rgba(19,43,67,1)","rgba(26,57,85,1)","rgba(30,64,96,1)","rgba(30,64,96,1)","rgba(30,64,96,1)","rgba(37,79,115,1)","rgba(43,90,130,1)","rgba(43,90,130,1)","rgba(43,90,130,1)","rgba(67,139,195,1)","rgba(71,148,207,1)","rgba(71,148,207,1)","rgba(71,148,207,1)","rgba(80,164,230,1)","rgba(86,177,247,1)","rgba(86,177,247,1)","rgba(86,177,247,1)"],"opacity":1,"size":5.66929133858268,"symbol":"x-thin-open","line":{"width":1.88976377952756,"color":["rgba(49,102,146,1)","rgba(55,114,162,1)","rgba(59,123,174,1)","rgba(59,123,174,1)","rgba(59,123,174,1)","rgba(22,49,75,1)","rgba(33,71,104,1)","rgba(62,130,183,1)","rgba(75,155,217,1)","rgba(19,43,67,1)","rgba(19,43,67,1)","rgba(19,43,67,1)","rgba(26,57,85,1)","rgba(30,64,96,1)","rgba(30,64,96,1)","rgba(30,64,96,1)","rgba(37,79,115,1)","rgba(43,90,130,1)","rgba(43,90,130,1)","rgba(43,90,130,1)","rgba(67,139,195,1)","rgba(71,148,207,1)","rgba(71,148,207,1)","rgba(71,148,207,1)","rgba(80,164,230,1)","rgba(86,177,247,1)","rgba(86,177,247,1)","rgba(86,177,247,1)"]}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.791762035340071,0.655800936557352,1.06654289010912,1.63520769625902,3.21238345131278,0.722059266269207,0.788386958092451,0.84810414519161,1.26963331699371,1.36395226474851,1.76847164649516,3.1035944018513,0.813036470301449,1.093810133636,1.9916994009167,3.24310798719525,1.1328686285764,1.1604629740119,2.20480421241373,3.00780370719731,0.641027402877808,1.02212434187531,1.94568943437189,2.94800576586276,1.3792331898585,1.13562753852457,2.08077999595553,2.96395810171962],"y":[1448.38722179122,1405.06958942749,1437.62766746208,1647.70070450231,1667.27594843525,660.674464038946,1561.86671343315,1287.79654199667,1021.23639988154,1547.99902387131,1561.21360203549,1235.98773535658,1339.30833713189,1697.7948146956,1766.88407347929,1502.30794995837,1652.19434202779,1457.07419977933,1655.81956987046,1808.32491938882,1542.29392063506,1555.8663311692,1658.87486411706,1597.73938258514,2409.68727407698,1584.33963594604,1839.97893564608,1299.79368294813],"text":["mouse.id: 1692<br />dummy: 1448<br />day: 37","mouse.id: 1692<br />dummy: 1405<br />day: 44","mouse.id: 1692<br />dummy: 1438<br />day: 49","mouse.id: 1693<br />dummy: 1648<br />day: 49","mouse.id: 1694<br />dummy: 1667<br />day: 49","mouse.id: 1692<br />dummy:  661<br />day:  4","mouse.id: 1692<br />dummy: 1562<br />day: 18","mouse.id: 1692<br />dummy: 1288<br />day: 53","mouse.id: 1692<br />dummy: 1021<br />day: 67","mouse.id: 1692<br />dummy: 1548<br />day:  0","mouse.id: 1693<br />dummy: 1561<br />day:  0","mouse.id: 1694<br />dummy: 1236<br />day:  0","mouse.id: 1692<br />dummy: 1339<br />day:  9","mouse.id: 1692<br />dummy: 1698<br />day: 14","mouse.id: 1693<br />dummy: 1767<br />day: 14","mouse.id: 1694<br />dummy: 1502<br />day: 14","mouse.id: 1692<br />dummy: 1652<br />day: 23","mouse.id: 1692<br />dummy: 1457<br />day: 30","mouse.id: 1693<br />dummy: 1656<br />day: 30","mouse.id: 1694<br />dummy: 1808<br />day: 30","mouse.id: 1692<br />dummy: 1542<br />day: 58","mouse.id: 1692<br />dummy: 1556<br />day: 63","mouse.id: 1693<br />dummy: 1659<br />day: 63","mouse.id: 1694<br />dummy: 1598<br />day: 63","mouse.id: 1692<br />dummy: 2410<br />day: 72","mouse.id: 1692<br />dummy: 1584<br />day: 79","mouse.id: 1693<br />dummy: 1840<br />day: 79","mouse.id: 1694<br />dummy: 1300<br />day: 79"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":["rgba(49,102,146,1)","rgba(55,114,162,1)","rgba(59,123,174,1)","rgba(59,123,174,1)","rgba(59,123,174,1)","rgba(22,49,75,1)","rgba(33,71,104,1)","rgba(62,130,183,1)","rgba(75,155,217,1)","rgba(19,43,67,1)","rgba(19,43,67,1)","rgba(19,43,67,1)","rgba(26,57,85,1)","rgba(30,64,96,1)","rgba(30,64,96,1)","rgba(30,64,96,1)","rgba(37,79,115,1)","rgba(43,90,130,1)","rgba(43,90,130,1)","rgba(43,90,130,1)","rgba(67,139,195,1)","rgba(71,148,207,1)","rgba(71,148,207,1)","rgba(71,148,207,1)","rgba(80,164,230,1)","rgba(86,177,247,1)","rgba(86,177,247,1)","rgba(86,177,247,1)"],"opacity":1,"size":5.66929133858268,"symbol":"x-thin-open","line":{"width":1.88976377952756,"color":["rgba(49,102,146,1)","rgba(55,114,162,1)","rgba(59,123,174,1)","rgba(59,123,174,1)","rgba(59,123,174,1)","rgba(22,49,75,1)","rgba(33,71,104,1)","rgba(62,130,183,1)","rgba(75,155,217,1)","rgba(19,43,67,1)","rgba(19,43,67,1)","rgba(19,43,67,1)","rgba(26,57,85,1)","rgba(30,64,96,1)","rgba(30,64,96,1)","rgba(30,64,96,1)","rgba(37,79,115,1)","rgba(43,90,130,1)","rgba(43,90,130,1)","rgba(43,90,130,1)","rgba(67,139,195,1)","rgba(71,148,207,1)","rgba(71,148,207,1)","rgba(71,148,207,1)","rgba(80,164,230,1)","rgba(86,177,247,1)","rgba(86,177,247,1)","rgba(86,177,247,1)"]}},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[3.00796980075538,3.21222051959485,0.706079869531095,1.97565157413483,3.12559509892017,2.83471928890795,3.33086391985416,3.31578607652336,3.36383441481739,0.928418369777501,1.96458769105375,3.17851159796119,3.22405616398901,1.27210784833878,2.26232687775046,3.24172204174101,2.60060070510954,1.0343716353178,2.32290834747255,2.82395041976124,3.3723111577332,0.750907911732793,2.13253168612719,3.05899771340191,2.88125793803483,1.02659171912819,2.30616683419794,3.21600354854017],"y":[1313.88534487635,1153.99021444842,1312.78026137426,1051.14534485228,1104.04116711058,998.916685398668,850.81185144335,880.306004293077,807.964445070922,1245.07733574398,1560.14473102298,1690.30791084822,1344.70989728812,1248.34564895686,1015.75393664949,1239.03426132966,1211.74747759812,1191.22338882461,1167.87448670808,1409.82849781532,1182.0268119486,1157.22262770683,1301.63418370709,1342.36113208644,1349.21070008818,1026.29439138751,1383.94985504076,1292.05584464241],"text":["mouse.id: 1699<br />dummy: 1314<br />day: 37","mouse.id: 1699<br />dummy: 1154<br />day: 44","mouse.id: 1697<br />dummy: 1313<br />day: 49","mouse.id: 1698<br />dummy: 1051<br />day: 49","mouse.id: 1699<br />dummy: 1104<br />day: 49","mouse.id: 1699<br />dummy:  999<br />day:  4","mouse.id: 1699<br />dummy:  851<br />day: 18","mouse.id: 1699<br />dummy:  880<br />day: 53","mouse.id: 1699<br />dummy:  808<br />day: 67","mouse.id: 1697<br />dummy: 1245<br />day:  0","mouse.id: 1698<br />dummy: 1560<br />day:  0","mouse.id: 1699<br />dummy: 1690<br />day:  0","mouse.id: 1699<br />dummy: 1345<br />day:  9","mouse.id: 1697<br />dummy: 1248<br />day: 14","mouse.id: 1698<br />dummy: 1016<br />day: 14","mouse.id: 1699<br />dummy: 1239<br />day: 14","mouse.id: 1699<br />dummy: 1212<br />day: 23","mouse.id: 1697<br />dummy: 1191<br />day: 30","mouse.id: 1698<br />dummy: 1168<br />day: 30","mouse.id: 1699<br />dummy: 1410<br />day: 30","mouse.id: 1699<br />dummy: 1182<br />day: 58","mouse.id: 1697<br />dummy: 1157<br />day: 63","mouse.id: 1698<br />dummy: 1302<br />day: 63","mouse.id: 1699<br />dummy: 1342<br />day: 63","mouse.id: 1699<br />dummy: 1349<br />day: 72","mouse.id: 1697<br />dummy: 1026<br />day: 79","mouse.id: 1698<br />dummy: 1384<br />day: 79","mouse.id: 1699<br />dummy: 1292<br />day: 79"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":["rgba(49,102,146,1)","rgba(55,114,162,1)","rgba(59,123,174,1)","rgba(59,123,174,1)","rgba(59,123,174,1)","rgba(22,49,75,1)","rgba(33,71,104,1)","rgba(62,130,183,1)","rgba(75,155,217,1)","rgba(19,43,67,1)","rgba(19,43,67,1)","rgba(19,43,67,1)","rgba(26,57,85,1)","rgba(30,64,96,1)","rgba(30,64,96,1)","rgba(30,64,96,1)","rgba(37,79,115,1)","rgba(43,90,130,1)","rgba(43,90,130,1)","rgba(43,90,130,1)","rgba(67,139,195,1)","rgba(71,148,207,1)","rgba(71,148,207,1)","rgba(71,148,207,1)","rgba(80,164,230,1)","rgba(86,177,247,1)","rgba(86,177,247,1)","rgba(86,177,247,1)"],"opacity":1,"size":5.66929133858268,"symbol":"x-thin-open","line":{"width":1.88976377952756,"color":["rgba(49,102,146,1)","rgba(55,114,162,1)","rgba(59,123,174,1)","rgba(59,123,174,1)","rgba(59,123,174,1)","rgba(22,49,75,1)","rgba(33,71,104,1)","rgba(62,130,183,1)","rgba(75,155,217,1)","rgba(19,43,67,1)","rgba(19,43,67,1)","rgba(19,43,67,1)","rgba(26,57,85,1)","rgba(30,64,96,1)","rgba(30,64,96,1)","rgba(30,64,96,1)","rgba(37,79,115,1)","rgba(43,90,130,1)","rgba(43,90,130,1)","rgba(43,90,130,1)","rgba(67,139,195,1)","rgba(71,148,207,1)","rgba(71,148,207,1)","rgba(71,148,207,1)","rgba(80,164,230,1)","rgba(86,177,247,1)","rgba(86,177,247,1)","rgba(86,177,247,1)"]}},"hoveron":"points","showlegend":false,"xaxis":"x3","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.60392768476158,1.24693603888154,2.23806944526732,2.72805931586772,1.94015313945711,1.6924507914111,2.04954756591469,1.92887894492596,1.10969149563462,1.84648390188813,3.11744997948408,0.892211057431996,2.39140811040998,2.86245405543596,2.2890026288107,0.660012990422547,2.12450231164694,3.3121031736955,1.75381105113775,0.990736053697765,1.82934398911893,2.74447769280523,2.15637526474893,1.19302397128195,1.8526496199891,2.79948220457882],"y":[1612.25308427252,1411.90551426467,1583.99468111116,1344.64311675355,1447.84601547513,1471.23723144755,1663.62398658078,1555.00695126355,1178.66011770815,1669.2928038666,1061.3231211409,1245.30173562821,1423.21054433808,1080.964564199,1423.63177936804,1396.37581750341,1549.38514071908,1255.08822454698,1499.87719141729,1203.73272164315,1624.27377123181,1285.95979573783,1576.69123127218,1112.92424822692,1503.79661843386,1051.05997539163],"text":["mouse.id: 1683<br />dummy: 1612<br />day: 44","mouse.id: 1681<br />dummy: 1412<br />day: 49","mouse.id: 1683<br />dummy: 1584<br />day: 49","mouse.id: 1684<br />dummy: 1345<br />day: 49","mouse.id: 1683<br />dummy: 1448<br />day:  4","mouse.id: 1683<br />dummy: 1471<br />day: 18","mouse.id: 1683<br />dummy: 1664<br />day: 53","mouse.id: 1683<br />dummy: 1555<br />day: 67","mouse.id: 1681<br />dummy: 1179<br />day:  0","mouse.id: 1683<br />dummy: 1669<br />day:  0","mouse.id: 1684<br />dummy: 1061<br />day:  0","mouse.id: 1681<br />dummy: 1245<br />day: 14","mouse.id: 1683<br />dummy: 1423<br />day: 14","mouse.id: 1684<br />dummy: 1081<br />day: 14","mouse.id: 1683<br />dummy: 1424<br />day: 23","mouse.id: 1681<br />dummy: 1396<br />day: 30","mouse.id: 1683<br />dummy: 1549<br />day: 30","mouse.id: 1684<br />dummy: 1255<br />day: 30","mouse.id: 1683<br />dummy: 1500<br />day: 58","mouse.id: 1681<br />dummy: 1204<br />day: 63","mouse.id: 1683<br />dummy: 1624<br />day: 63","mouse.id: 1684<br />dummy: 1286<br />day: 63","mouse.id: 1683<br />dummy: 1577<br />day: 72","mouse.id: 1681<br />dummy: 1113<br />day: 79","mouse.id: 1683<br />dummy: 1504<br />day: 79","mouse.id: 1684<br />dummy: 1051<br />day: 79"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":["rgba(55,114,162,1)","rgba(59,123,174,1)","rgba(59,123,174,1)","rgba(59,123,174,1)","rgba(22,49,75,1)","rgba(33,71,104,1)","rgba(62,130,183,1)","rgba(75,155,217,1)","rgba(19,43,67,1)","rgba(19,43,67,1)","rgba(19,43,67,1)","rgba(30,64,96,1)","rgba(30,64,96,1)","rgba(30,64,96,1)","rgba(37,79,115,1)","rgba(43,90,130,1)","rgba(43,90,130,1)","rgba(43,90,130,1)","rgba(67,139,195,1)","rgba(71,148,207,1)","rgba(71,148,207,1)","rgba(71,148,207,1)","rgba(80,164,230,1)","rgba(86,177,247,1)","rgba(86,177,247,1)","rgba(86,177,247,1)"],"opacity":1,"size":5.66929133858268,"symbol":"x-thin-open","line":{"width":1.88976377952756,"color":["rgba(55,114,162,1)","rgba(59,123,174,1)","rgba(59,123,174,1)","rgba(59,123,174,1)","rgba(22,49,75,1)","rgba(33,71,104,1)","rgba(62,130,183,1)","rgba(75,155,217,1)","rgba(19,43,67,1)","rgba(19,43,67,1)","rgba(19,43,67,1)","rgba(30,64,96,1)","rgba(30,64,96,1)","rgba(30,64,96,1)","rgba(37,79,115,1)","rgba(43,90,130,1)","rgba(43,90,130,1)","rgba(43,90,130,1)","rgba(67,139,195,1)","rgba(71,148,207,1)","rgba(71,148,207,1)","rgba(71,148,207,1)","rgba(80,164,230,1)","rgba(86,177,247,1)","rgba(86,177,247,1)","rgba(86,177,247,1)"]}},"hoveron":"points","showlegend":false,"xaxis":"x4","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,3,3,3,3,3,3],"y":[1331,1525,1369,1683,1480,1637,1499,1292,1323,1674,1313,1475,1449,1579,1497,1382,1576,1740,1747,1425,1775,1544,1851,1547,1648,1557,1664,1512],"hoverinfo":"y","type":"box","fillcolor":"rgba(255,255,255,1)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"},"size":5.66929133858268},"line":{"color":"rgba(51,51,51,1)","width":1.88976377952756},"showlegend":false,"xaxis":"x","yaxis":"y","frame":null},{"x":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,3,3,3,3,3,3],"y":[661,1562,1339,1288,1405,1457,1448,1021,1556,1548,2410,1698,1652,1438,1584,1542,1656,1648,1561,1767,1840,1659,1502,1667,1300,1236,1808,1598],"hoverinfo":"y","type":"box","fillcolor":"rgba(255,255,255,1)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"},"size":5.66929133858268},"line":{"color":"rgba(51,51,51,1)","width":1.88976377952756},"showlegend":false,"xaxis":"x2","yaxis":"y","frame":null},{"x":[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,1,1,1,1,1,1,2,2,2,2,2,2],"y":[1154,880,1410,1690,1314,808,851,999,1239,1104,1182,1212,1349,1292,1342,1345,1191,1313,1157,1245,1026,1248,1016,1560,1302,1168,1051,1384],"hoverinfo":"y","type":"box","fillcolor":"rgba(255,255,255,1)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"},"size":5.66929133858268},"line":{"color":"rgba(51,51,51,1)","width":1.88976377952756},"showlegend":false,"xaxis":"x3","yaxis":"y","frame":null},{"x":[2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,3,3,3,3,3,3],"y":[1549,1471,1612,1500,1584,1624,1669,1448,1555,1664,1504,1424,1423,1577,1412,1179,1204,1245,1113,1396,1061,1345,1286,1255,1081,1051],"hoverinfo":"y","type":"box","fillcolor":"rgba(255,255,255,1)","marker":{"opacity":null,"outliercolor":"rgba(0,0,0,1)","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"},"size":5.66929133858268},"line":{"color":"rgba(51,51,51,1)","width":1.88976377952756},"showlegend":false,"xaxis":"x4","yaxis":"y","frame":null},{"x":[1],"y":[1000],"name":"99_7f1c47b14b9868e6aa379be97eb94aeb","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"skip","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#132B43"],[0.0526315789473684,"#16314B"],[0.105263157894737,"#193754"],[0.157894736842105,"#1D3E5C"],[0.210526315789474,"#204465"],[0.263157894736842,"#234B6E"],[0.315789473684211,"#275277"],[0.368421052631579,"#2A5980"],[0.421052631578947,"#2E608A"],[0.473684210526316,"#316793"],[0.526315789473684,"#356E9D"],[0.578947368421053,"#3875A6"],[0.631578947368421,"#3C7CB0"],[0.684210526315789,"#3F83BA"],[0.736842105263158,"#438BC4"],[0.789473684210526,"#4792CE"],[0.842105263157895,"#4B9AD8"],[0.894736842105263,"#4EA2E2"],[0.947368421052632,"#52A9ED"],[1,"#56B1F7"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"thickness":23.04,"title":"day","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"tickmode":"array","ticktext":["0","20","40","60"],"tickvals":[0,0.253164556962025,0.506329113924051,0.759493670886076],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":42.3013698630137,"r":18.9954337899543,"b":44.5662100456621,"l":48.9497716894977},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,0.242389649923896],"automargin":true,"type":"linear","autorange":false,"range":[0.4,3.6],"tickmode":"array","ticktext":["1686","1688","1690"],"tickvals":[1,2,3],"categoryorder":"array","categoryarray":["1686","1688","1690"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":"","hoverformat":".2f"},"annotations":[{"text":"Mouse ID","x":0.5,"y":-0.0471841704718417,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"top","annotationType":"axis"},{"text":"number of variants","x":-0.0357686453576865,"y":0.5,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-90,"xanchor":"right","yanchor":"center","annotationType":"axis"},{"text":"Ciprofloxacin","x":0.121194824961948,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"Tetracyclin","x":0.375,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"Vancomycin","x":0.625,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"Water","x":0.878805175038052,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"}],"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[573.208187240893,2497.46627679805],"tickmode":"array","ticktext":["1000","1500","2000"],"tickvals":[1000,1500,2000],"categoryorder":"array","categoryarray":["1000","1500","2000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.242389649923896,"y0":0,"y1":1},{"type":"rect","fillcolor":"rgba(255,255,255,1)","line":{"color":"rgba(0,0,0,1)","width":1.32835201328352,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":0.242389649923896,"y0":0,"y1":23.37899543379,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.257610350076104,"x1":0.492389649923896,"y0":0,"y1":1},{"type":"rect","fillcolor":"rgba(255,255,255,1)","line":{"color":"rgba(0,0,0,1)","width":1.32835201328352,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.257610350076104,"x1":0.492389649923896,"y0":0,"y1":23.37899543379,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.507610350076104,"x1":0.742389649923896,"y0":0,"y1":1},{"type":"rect","fillcolor":"rgba(255,255,255,1)","line":{"color":"rgba(0,0,0,1)","width":1.32835201328352,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.507610350076104,"x1":0.742389649923896,"y0":0,"y1":23.37899543379,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.757610350076104,"x1":1,"y0":0,"y1":1},{"type":"rect","fillcolor":"rgba(255,255,255,1)","line":{"color":"rgba(0,0,0,1)","width":1.32835201328352,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.757610350076104,"x1":1,"y0":0,"y1":23.37899543379,"yanchor":1,"ysizemode":"pixel"}],"xaxis2":{"type":"linear","autorange":false,"range":[0.4,3.6],"tickmode":"array","ticktext":["1692","1693","1694"],"tickvals":[1,2,3],"categoryorder":"array","categoryarray":["1692","1693","1694"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"domain":[0.257610350076104,0.492389649923896],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":"","hoverformat":".2f"},"xaxis3":{"type":"linear","autorange":false,"range":[0.4,3.6],"tickmode":"array","ticktext":["1697","1698","1699"],"tickvals":[1,2,3],"categoryorder":"array","categoryarray":["1697","1698","1699"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"domain":[0.507610350076104,0.742389649923896],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":"","hoverformat":".2f"},"xaxis4":{"type":"linear","autorange":false,"range":[0.4,3.6],"tickmode":"array","ticktext":["1681","1683","1684"],"tickvals":[1,2,3],"categoryorder":"array","categoryarray":["1681","1683","1684"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"domain":[0.757610350076104,1],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":"","hoverformat":".2f"},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"9ca841e31a":{"x":{},"y":{},"colour":{},"type":"scatter"},"9ca1da4c432":{"x":{},"y":{},"colour":{}}},"cur_data":"9ca841e31a","visdat":{"9ca841e31a":["function (y) ","x"],"9ca1da4c432":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 4.3: number of variants of all 12 OMM genomes by mouse
</p>
</div>
</div>
</div>
<div id="heatmap-1" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Heatmap</h2>
<p>All mice</p>
<p>```{r, fig.align=center, fig.width=5, fig.height=10}dat &lt;- readRDS(data/rds/omm_ab.rds)
dat<span class="math inline">\(sample.id &lt;- paste0(dat\)</span>mouse.id, -,dat<span class="math inline">\(day) dat\)</span>variant.id &lt;- paste0(dat<span class="math inline">\(POS, &quot;-&quot;, dat\)</span>REF, -, dat<span class="math inline">\(ALT) data.wide &lt;- dcast(dat, variant.id ~ sample.id, value.var = &quot;AF&quot;) data.wide[is.na(data.wide)] &lt;- 0 rownames(data.wide) &lt;- data.wide\)</span>variant.id
data.wide$variant.id &lt;- NULL</p>
<p>library(circlize)
library(ComplexHeatmap)</p>
<p>heat &lt;- data.matrix(data.wide)
# limit to variants that are present in at least 10% of samples
heat_num &lt;- rowSums(heat != 0)
heat2 &lt;- heat[which(heat_num &gt; ncol(heat)/10),]</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="resequencing-samples.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="limit-to-variants-that-have-a-high-variance.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
